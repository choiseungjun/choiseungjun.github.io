!function(e,t,i){"use strict";if(!t.ui.Gesture){var n=t.ui("Gesture",{bindjQuery:"Gesture",defaults:{container:document,threshold:50,direction:"horizontal",gesture:null,gestureStart:null,gestureMove:null,gestureEnd:null},initialize:function(e,t){var i=this;!1!==i.supr(e,t)&&(i.isHoriz="horizontal"===i.options.direction||"both"===i.options.direction,i.isVerti="vertical"===i.options.direction||"both"===i.options.direction,i._bindGestureEvents())},_getEventPoint:function(e,t){var i=e.originalEvent||e;return i="end"===t||"touchend"===e.type?i.changedTouches&&i.changedTouches[0]||i:i.touches&&i.touches[0]||i,{x:i.pageX||i.clientX,y:i.pageY||i.clientY}},_getAngle:function(e,t){var i=e.x-t.x,n=t.y-e.y,r=Math.atan2(n,i),o=Math.round(180*r/Math.PI);return o<0&&(o=360-Math.abs(o)),o},_getDirection:function(e,t,i){var n,r=!i||"horizontal"===i||"both"===i;return r!=(!i||"vertical"===i||"both"===i)?r?e.x>t.x?"left":e.x==t.x?"":"right":e.y>t.y?"down":e.y==t.y?"":"up":(n=this._getAngle(e,t))<=45&&n>=0?"left":n<=360&&n>=315?"left":n>=135&&n<=225?"right":n>45&&n<135?"down":"up"},_getDiff:function(e,t){return{x:e.x-t.x,y:e.y-t.y}},_bindGestureEvents:function(){var t,i,n=this,r=!1,o=!1;n.$el.on("mousedown.gesture, touchstart.gesture",function(s){"mousedown"===s.type&&s.preventDefault(),i=t=n._getEventPoint(s),r=o=!1,e(n.options.container).on("mousemove.gesture"+n.cid+" touchmove.gesture"+n.cid,function(e){var i,s,u,a=n._getEventPoint(e);if(t&&!o){if(i=n._getDiff(a,t),!r)if(u=Math.abs(i.y)/(Math.abs(i.x)||1),s=Math.abs(i.x)/(Math.abs(i.y)||1),u<1&&n.isHoriz||s<1&&n.isVerti){if(a.event=e,!1===n._gestureCallback("start",a))return;if(!1===n.triggerHandler("gesturestart",a))return;r=!0,n.$el.on("mousemove.gesture touchmove.gesture",function(e){e.preventDefault()})}else(n.isHoriz&&u>1||n.isVerti&&s>1)&&(o=!0);if(r){if(e.stopPropagation(),e.preventDefault(),a.diff=i,a.direction=n._getDirection(t,a,n.options.direction),a.event=e,!1===n._gestureCallback("move",a))return;if(!1===n.triggerHandler("gesturemove",a))return}}}).on("mouseup.gesture"+n.cid+" mousecancel.gesture"+n.cid+" touchend.gesture"+n.cid+" touchcancel.gesture"+n.cid,function(i){if(r&&t){var s=n._getEventPoint(i,"end");switch(s.diff=n._getDiff(s,t),s.direction=n._getDirection(t,s,n.options.direction),s.event=i,Math.abs(s.diff.x)>n.options.threshold||Math.abs(s.diff.y)>n.options.threshold?(n._gestureCallback("end",s),n.triggerHandler("gestureend",s)):(n._gestureCallback("cancel",s),n.triggerHandler("gesturecancel",s)),n.$el.off("mousemove.gesture touchmove.gesture"),s.direction){case"left":case"right":Math.abs(s.diff.x)>n.options.threshold&&n.isHoriz&&(n._gestureCallback(s.direction,s),n.triggerHandler("gesture"+s.direction));break;case"up":case"down":Math.abs(s.diff.y)>n.options.threshold&&n.isVerti&&(n._gestureCallback(s.direction,s),n.triggerHandler("gesture"+s.direction))}}t=null,o=!1,e(n.options.container).off(".gesture"+n.cid)})}).on("click.gesture","a, button",function(e){if(i){var t=n._getEventPoint(e);i.x==t.x&&i.y==t.y||(e.preventDefault(),e.stopPropagation())}})},_gestureCallback:function(e,t){var i,n=this;return n.options["gesture"+e]&&(i=n.options["gesture"+e].call(n,t)),n.options.gesture&&(i=n.options.gesture.call(n,e,t)),i},release:function(){this.$el.off(".gesture"+this.cid).off(".gesture"),e(this.options.container).off(".gesture"+this.cid),this.supr()}});t.ui.Gesture=n}}(jQuery,window[LIB_NAME]);