!function(e,t,l){"use strict";if(!t.ui.Selectbox){var s=e(document),i=e(window),o=t.detect.isTouch,a=t.ui.View.extend({name:"Selectbox",templates:{notextOption:'<span class="ui-select-text"></span><span class="hide"></span><span class="ico"></span>',labelOption:'<span class="ui-select-text" _style="text-overflow: ellipsis;width: 100%;display: inline-block;overflow: hidden;">{{text}}</span><span class="hide">선택됨</span><span class="ico"></span>'},initialize:function(e,t){var l=this;!1!==l.supr(e,t)&&l.$el.attr("data-class")&&l.$el.attr("data-class").indexOf("read")>-1&&l.$el.prop("readonly",!0)},_options:function(e){t.each(t.toArray(this.el.options),e)},_isDeactive:function(){var e=this;return e.$el.prop("disabled")||!0===e.$el.prop("readonly")},_itemHTML:function(e,t){var l=this;return e?"label"===t?l.templated.labelOption(e):e.text:l.templated.notextOption()},selectedIndex:function(t,l){if(0===arguments.length)return this.el.selectedIndex;if(0!==this.el.options.length){var s=e.Event("beforechange");this.$el.trigger(s),s.isDefaultPrevented()||(this.el.selectedIndex=t,!1!==l?this.$el.trigger("change",{selectedIndex:this.el.selectedIndex}):this._updateLabel())}},value:function(e,t){var l=this;if(0===arguments.length)return l.el.value;0!==l.el.options.length&&this._options(function(s,i){if(s.value===e+"")return l.selectedIndex(i,t),!1})},text:function(e,t){var l=this;if(0===arguments.length)return this.el.value;0!==l.el.options.length&&this._options(function(s,i){if(s.text===e+"")return l.selectedIndex(i,t),!1})},selectedOption:function(){return this.el.options[this.el.selectedIndex]},_updateLabel:function(e){var t=this,l=!t._isDeactive(),s=t.$label.children(),i=t.$el.hasClass("read")||!0===t.$el.prop("readonly"),o=t.$el.prop("disabled");(e=void 0===e?t.el.selectedIndex:e)<0&&t.el.options.length>0&&(t.el.selectedIndex=e=0),t.attrTitle=t.$el.attr("title")||t.$el.attr("data-title"),t.$selectbox.toggleClass("read",i&&!o).toggleClass("disabled",o).toggleClass("warn",t.$el.is("[data-class*=warn]")),s.attr("title",t.attrTitle+" 열기").find(".hide").text(l?"선택됨":"선택불가"),s.html(t._itemHTML(e<0?null:t.el.options[e],"label")),l?s.removeAttr("tabindex"):t.$el.prop("disabled")&&s.attr("tabindex",-1)},update:function(e,l){var s=this;e&&(t.is(e,"array")?(s.el.options.length=0,t.each(e,function(e,l){"text"in e?s.el.options.add(new Option(e.text||e.value,e.value)):t.each(e,function(e,t){return s.el.options.add(new Option(e,t)),!1})})):t.is(e,"json")&&(s.el.options.length=0,t.each(e,function(e,t){s.el.options.add(new Option(e,t))})),l&&(s.el.value=l))},show:function(){this.display=!0,this.$selectbox.toggle(this.display)},hide:function(){this.display=!1,this.$selectbox.toggle(this.display)},toggle:function(e){0===arguments.length&&(e=!this.display),this.display=e,this.$selectbox.toggle(this.display)},readonly:function(e){this.$el.toggleClass("read",e).prop("readonly",e),this.update()},disabled:function(e){this.$el.toggleClass("disabled",e).prop("disabled",e),this.update()}}),n=t.ui("CusomtSelectbox",a,{$statics:{ON_CHANGED:"selectboxchanged"},defaults:{classSort:["sup","cnum","cname"],allowScrollbar:!0,containerMargin:2,where:"inline",wrapClasses:"",disabledClass:"disabled"},templates:{label:'<div class="ui-selectbox-view"><a href="#0" class="ui-select-button" title="">{{#raw html}}</a></div>',list:'<div class="ui-selectbox-list" id="{{cid}}_menu"><div class="ui-select-scrollarea"></div></div>',scrollbar:'<div class="ui-select-scroll" style="top: 0px;"><span class="bg_top"></span><span class="bg_mid" style=""></span><span class="bg_btm"></span></div>',option:'<li><a href="#{{num}}" data-value="{{value}}" data-text="{{text}}" title="{{attrTitle}}">{{#raw html}}</a></li>'},initialize:function(e,t){var l=this;!1!==l.supr(e,t)&&(l.display="none"!==l.$el.css("display"),l.$el.hide(),l._create(),l.update())},_create:function(){var t=this,l=t.$el.attr("data-class")||"ui-selectbox-wrap",s=t.options.id?' id="'+t.options.id+'"':"";t.originalWidth=parseInt(t.$el.css("width"),10)+22,t.attrTitle=t.options.title||t.$el.attr("title")||"셀렉트박스",t.options.wrapClasses&&(l=l+" "+t.options.wrapClasses),t.$selectbox=e('<div class="'+l+'" '+s+"></div>"),t.options.widthClass?t.$selectbox.addClass(t.options.widthClass):t.$selectbox.css("width",t.originalWidth),t.$selectbox.insertAfter(t.$el),t._createLabel(),t._createList(),t._bindEvents()},_bindEvents:function(){var l,i=this;i.on("selectboxopen selectboxclose",function(t){if(!i._isDeactive()){var o="selectboxopen"===t.type;i.$selectbox.toggleClass("on",o),i.$el.closest("div.select_wrap").toggleClass("on",o),o?(i._reposition(),i.$list.show(),i._refreshScroll(),i._scrollToItem(),s.on("touchstart.selectbox"+i.cid+" mousedown.selectbox"+i.cid,function(t){e.contains(i.$selectbox[0],t.target)||(clearTimeout(l),l=null,i.close())}),c.active=i):(i.$list.hide(),c.active=null,clearTimeout(l),l=null,s.off(".selectbox"+i.cid)),i.isShown=o,i.$label.find(".ui-select-button").attr("title",i.attrTitle+(o?" 닫기":" 열기"))}}),i.$el.on("change",function(){i._updateLabel(this.selectedIndex)}),o||i.$selectbox.on("mouseenter.selectbox mouseleave.selectbox focusin.selectbox focusout.selectbox",function(e){clearTimeout(l),l=null,i.$el.prop("disabled")||("mouseenter"===e.type||"focusin"===e.type?i.$selectbox.addClass("active"):"mouseleave"!==e.type&&"focusout"!==e.type||(i.$selectbox.removeClass("active"),"focusout"===e.type&&i.$selectbox.hasClass("on")&&(l=setTimeout(function(){i.close()},200))))}).on("keydown",function(e){if(i.isShown)switch(e.keyCode){case t.keyCode.ESCAPE:i.close(),i.$label.find("a").focus()}});var a;e(window).on("changemediasize."+i.cid,a=function(e,t){i.isShown&&i._refreshScroll(),i._updateLabel()}),a(),e(i.el.form).on("reset",function(){setTimeout(function(){i.update()})})},_createLabel:function(){var t=this;t.$label=e(t.templated.label({html:t._itemHTML(t.el.selectedIndex>=0?t.el.options[t.el.selectedIndex]:null,"label")})),t.$label.attr({id:t.cid+"_button"}).on("click",".ui-select-button",function(e){if(e.preventDefault(),t!==c.active)if(t.$selectbox.hasClass("on"))t.close();else{if(t._isDeactive())return;t.open()}else t.close()}),!o&&t.$selectbox.on("keydown",".item_view a",function(e){t._isDeactive()||40===e.keyCode&&(t.isShown||t.open(),t.$list.find("li>a:eq(0)").focus(),e.preventDefault())}),t.$selectbox.append(t.$label)},_createList:function(){var t=this;t.$list=e(t.templated.list({cid:t.cid})),t.$selectbox.append(t.$list),t.$listWrapper=t.$list.children(),t.$selectbox.on("click",".ui-selectbox-list",function(e){t.$list.focus()}).on("click",".ui-selectbox-list li>a",function(l){l.preventDefault(),l.stopPropagation(),t.selectedIndex(e(this).parent().index()),t.close(),t.$label.find("a").focus()}),!o&&t.$selectbox.on("mousedown",".ui-selectbox-list li>a",function(){this.focus()}).on("keydown",".ui-selectbox-list a",function(e){if((38==e.keyCode||40==e.keyCode)&&t.isShown){e.preventDefault();var l=t.$selectbox.find("a"),s=l.index(this),i=l.length;switch(e.keyCode){case 38:l.eq(Math.max(0,s-1)).focus();break;case 40:l.eq(Math.min(i,s+1)).focus()}}}),t.maxHeight=parseInt(t.$listWrapper.css("max-height"),10),t.$scrollbar=e(t.templated.scrollbar()),t.$list.append(t.$scrollbar),o||t.$list.on("mouseenter mouseleave",function(e){t.isScrollbarActive="mouseenter"===e.type,t.$scrollbar.toggleClass("active",t.isScrollbarDown||t.isScrollbarActive)})},_reposition:function(){var t,l,s,i,o,a,n=this;0!==(t=n.$selectbox.parentsUntil("body").filter(function(){var t=e(this).css("overflowY");return"hidden"===t||"auto"===t})).size()&&(l=t.scrollTop(),a=t.prop("scrollHeight"),o=n.$selectbox.innerHeight(),s=n.$selectbox.offset().top-t.offset().top+l,n.$list.css("visibility","hidden").show(),i=n.$listWrapper.innerHeight(),n.$list.css("visibility","").hide(),s+i+o>a&&s-l>i?(n.$selectbox.addClass("up"),n.$list.css("marginTop",-1*(i+o+3))):(n.$selectbox.removeClass("up"),n.$list.css("marginTop","")))},open:function(){var e=this;c.active&&c.active.close(),"body"===e.options.where&&e.$list.css({position:"absolute",zIndex:9e3,top:e.$label.offset().top+e.$label.height(),left:e.$label.offset().left}).appendTo("body"),e.triggerHandler("selectboxopen")},close:function(){var e=this;e.triggerHandler("selectboxclose"),"body"===e.options.where&&e.$label.after(e.$list.css({position:"",zIndex:"",top:"",left:""}))},selectedIndex:function(e,l){var s=this;if(0===arguments.length)return s.el.selectedIndex;s.supr.apply(s,t.toArray(arguments)),s.$list.find("li").removeClass("on").eq(s.el.selectedIndex).addClass("on")},value:function(e,l){var s=this;if(0===arguments.length)return s.el.options[s.el.selectedIndex].value;s.supr.apply(s,t.toArray(arguments))},update:function(e,t){var l=this,s="",i=1,o=l.$el.prop("disabled"),a=!0===l.$el.prop("readonly");l.close(),e&&l.supr(e,t),l._updateLabel(),a||o||(l._options(function(e,t){s+=l.templated.option({num:i++,value:e.value,text:e.text,attrTitle:l.attrTitle,html:l._itemHTML(e)})}),l.$listWrapper.empty().html("<ul>"+s+"</ul>").find("li:eq("+l.el.selectedIndex+")").addClass("on"),l.$selectbox.toggle(l.display))},setTitle:function(e){this.$listWrapper.find("a").attr("title",this.attrTitle=e)},readonly:function(e){var t=this;t.supr(e),t.close(),t.update()},disabled:function(e){var t=this;t.supr(e),t.close(),t.update()},_bindScrollEvent:function(){var e=this,l=e.$listWrapper;l.on("scroll",function(){e.isScrollbarDown||e._scrollUpdate()}),o?e.$list.vcGesture({direction:"vertical",gesture:function(){var t=0;return function(s,i){if(!e.isVisibleScrollbar)return!1;switch(s){case"start":t=l.scrollTop();break;case"move":l.scrollTop(t-i.diff.y)}}}()}):(e.options.allowScrollbar&&e.$scrollbar.vcGesture({direction:"vertical",gesture:function(){var t,l,s,i,o,a;return function(n,r){if(!e.isVisibleScrollbar)return!1;switch(n){case"start":e.isScrollbarDown=!0,t=parseInt(e.$scrollbar.css("top"),10),i=e.$scrollbar.height(),o=e.$listWrapper.height(),a=e.$listWrapper.prop("scrollHeight");break;case"move":if(!e.isScrollbarDown)return;l=e._scrollbarMove(t+r.diff.y),s=l/(o-i),e.$listWrapper.scrollTop(s*(a-o));break;default:e.isScrollbarDown=!1,!e.isScrollbarActive&&e.$scrollbar.removeClass("active")}}}()}),e.$selectbox.on("mousewheel DOMMouseScroll wheel",function(s){if(e.isVisibleScrollbar){var i=s.originalEvent,o=40*t.dom.getDeltaY(i),a=l.scrollTop();l.scrollTop(a-o),s.preventDefault(),s.stopPropagation()}}))},_hideScroll:function(){var e=this;e.isVisibleScrollbar=!1,e.$scrollbar.hide().css({height:0,top:0}).find("span.bg_mid").css("height",0)},_scrollUpdate:function(){var e=this;if(e.isVisibleScrollbar){var t=(e.wrapperHeight-e.scrollBarHeight)/(e.scrollerHeight-e.wrapperHeight);e._scrollbarMove(e.$listWrapper.scrollTop()*t)}},_scrollbarMove:function(e){var t=this;if(t.isVisibleScrollbar)return e=Math.min(t.scrollHeight,Math.max(0,e)),t.$scrollbar.css({height:Math.ceil(t.scrollBarHeight),top:e}).find("span.bg_mid").css("height",Math.ceil(t.scrollBarHeight)-24),e},_scrollTop:function(e){var t=this;t.$listWrapper.scrollTop(e*t.scrollRate),t._scrollUpdate()},_scrollToItem:function(){var e=this,t=e.el.selectedIndex;if(t>0){var l,s,i=e.$list.find("li").eq(t),o=e.$listWrapper.scrollTop(),a=i.position().top+o,n=e.$list.height();(a<o||a>=n+o)&&(l=i.height(),s=e.$listWrapper.height(),e.$listWrapper.scrollTop(a-s/2+l/2))}else e.$listWrapper.scrollTop(0)},_refreshScroll:function(){var e=this;e.scrollerHeight=e.$list.find("ul").height(),e.maxHeight>e.scrollerHeight?e._hideScroll():(e.wrapperHeight=e.$listWrapper.height(),e.scrollerHeight<=e.wrapperHeight?e._hideScroll():(e.$selectbox.hasClass("on")&&(e.$scrollbar.show(),e.isVisibleScrollbar=!0),e._bindedOverEvents||(e._bindedOverEvents=!0,e._bindScrollEvent()),e.scrollRate=e.wrapperHeight/e.scrollerHeight,e.scrollBarHeight=Math.max(30,e.wrapperHeight*e.scrollRate),e.scrollHeight=e.wrapperHeight-e.scrollBarHeight,e.isScrollbarDown=!1,e.moveY=0,e._scrollUpdate()))},release:function(){var e=this;s.off(".selectbox"+e.cid),i.off("."+e.cid),e.$scrollbar.off(),e.$label.off().remove(),e.$list.off().remove(),e.$selectbox.off().remove(),e.$el.off("change.selectbox").show().unwrap("<div></div>"),e.supr()}}),r=t.ui("PickerSelectbox",a,{templates:{label:'<div class="ui-selectbox-view"><a href="#0" class="ui-select-button" title="">{{#raw html}}</a></div>'},initialize:function(e,t){var l=this;!1!==l.supr(e,t)&&(l._create(),l._bindEvents())},_create:function(){var t=this,l=t.$el.attr("data-class")||"ui-selectbox-wrap",s=t.options.id?' id="'+t.options.id+'"':"";t.originalWidth=parseInt(t.$el.css("width"),10)+22,t.attrTitle=t.options.title||t.$el.attr("title")||"셀렉트박스",t.options.wrapClasses&&(l=l+" "+t.options.wrapClasses),t.$selectbox=e('<div class="'+l+'" '+s+"></div>"),t.options.widthClass?t.$selectbox.addClass(t.options.widthClass):t.$selectbox.css("width",t.originalWidth),t.$el.css({"-webkit-appearance":"none","-moz-appearance":"none","border-radius":0,opacity:0,position:"absolute",top:0,left:0,bottom:0,width:"100%"}),t.$selectbox.insertBefore(t.$el),t.$label=e(t.templated.label({html:t._itemHTML(t.el.options[t.el.selectedIndex],"label")})).appendTo(t.$selectbox),t.$selectbox.prepend(t.$el),t.display="none"!==t.$el.css("display"),t.$selectbox.toggle(t.display),t._updateLabel()},_bindEvents:function(){var e=this;e.$el.on("change",function(){e._updateLabel(e.el.selectedIndex)}).on("focusin focusout",function(t){e.$selectbox.toggleClass("active","focusin"===t.type)})},_updateLabel:function(){this.supr(),!0===this.$el.prop("readonly")&&this.$el.hide()},update:function(e,t){e&&this.supr(e,t),this._updateLabel()}}),c=t.ui("Selectbox",{bindjQuery:"Selectbox",defaults:{allowPicker:!0},initialize:function(e,l){var s=this;!1!==s.supr(e,l)&&(delete s.options.on,delete s.options.events,"f_wd_one"===s.$el.attr("data-width-class")&&(s.options.allowPicker=!1),t.detect.isTouch&&t.detect.isMobile&&!1!==s.options.allowPicker?s.sel=new r(e,s.options):s.sel=new n(e,s.options),s.$selectbox=s.sel.$selectbox,t.each(["selectedIndex","value","text","selectedOption","update","hide","show","toggle","readonly","disabled"],function(e){s[e]=function(){return this.sel[e].apply(this.sel,[].slice.call(arguments,0))}}))}});t.ui.setDefaults("Selectbox",{events:{selectboxopen:function(t){this.options.preventZindex||this.$el.parentsUntil("#wrap").filter(function(t){return"relative"===e(this).css("position")}).addClass("zindex")},selectboxclose:function(e){this.options.preventZindex||this.$el.parents(".zindex").removeClass("zindex")}}}),"function"==typeof define&&define.amd&&define([],function(){return c})}}(jQuery,window[LIB_NAME]);