!function(e,r,o){"use strict";if(!r.ui.Scrollview){e.easing.smooth=function(e,r,o,t,l){var a=(r/=l)*r;return o+t*(-1*a*a+4*(a*r)+-6*a+4*r)};var t=r.css3.prefix("transform"),l=r.detect.isTouch,a=r.ui("Scrollview",{bindjQuery:"scrollview",selectors:{wrapper:">.ui_scrollarea",scroller:">.ui_scrollarea>.ui_content",vscrollbar:">.ui_scrollbar"},defaults:{duration:600,speedLimit:1.2,moveThreshold:100,offsetThreshold:30,startThreshold:5,acceleration:.1,accelerationT:250,watch:!0,watchInterval:400,preventScroll:!0},initialize:function(r,o){var t=this;if(!1!==t.supr(r,o)){t.maxScrollY=0,t.scrollHeight=0,t.wrapperHeight=0,t.visibleScroll=!1,0===t.$vscrollbar.size()&&(t.$vscrollbar=e('<div class="scroll ui_scrollbar"><span class="bg_top"></span><span class="bg_mid"></span><span class="bg_btm"></span></div>'),t.$el.append(t.$vscrollbar)),t.scrollbarStyle=t.$vscrollbar[0].style,t.scrollbarStyle.display="none";var l=t.$vscrollbar.find("span.bg_mid");l.length&&(t.scrollbarInnerStyle=l[0].style,t.scrollbarInnerStyle.paddingBottom=0),t.$el.attr("tabindex",0),t._bindEvents()}},_bindEvents:function(){var r=this;if(r.$vscrollbar.size()&&(r.$wrapper.on("scroll",function(){var e=(r.wrapperHeight-r.scrollbarHeight)/(r.scrollHeight-r.wrapperHeight);r._moveScrollbar(r.$wrapper[0].scrollTop*e)}),!0===r.options.watch)){var o=0,t=r.options.watchInterval;r.updateTimer=setInterval(function(){if(o>4e4){if(o=0,!e.contains(document,r.$el[0]))return clearInterval(r.updateTimer),void(r.updateTimer=null)}else o+=t;r.update()},t)}},_watchStart:function(){},_bindContentScroll:function(){var e,o,t,l,a,s,i,n,c,p,u=this,h={},v=1,d=r.dom;u.$el.on("touchstart touchmove touchend touchcancel",function(r){var b,f,w,m,g,$;switch(h[r.type]=r.timeStamp,c=d.getEventPoint(r),$=c.y,r.type){case"touchstart":if(s=u.wrapperHeight,i=u.$wrapper[0].scrollHeight-s,!(a=i>0))return;n=u.$wrapper[0].scrollTop,t=c.x,o=c.y,v=1,p=!1,u.$wrapper.is(":animated")&&h.touchstart-h.touchend<u.options.accelerationT?v+=u.options.acceleration:v=1,u.$wrapper.stop(!0,!1).data("scrollTop",u.$wrapper.scrollTop());break;case"touchmove":if(!p&&Math.abs(t-c.x)>Math.abs(o-c.y)&&(a=!1),!a)return;if(u.options.preventScroll)r.preventDefault();else{if(o<$&&0===n)return;if(o>$&&n===i)return;r.preventDefault()}e=o-$,l=Math.abs(e/(h.touchmove-h.touchstart)),m=u.$wrapper.data("scrollTop")+e,g=0,v=1,p=!0,m<0?m=0:m>i&&(m=i),u.$wrapper.stop(!0,!1).scrollTop(m),r.stopPropagation();break;case"touchend":case"touchcancel":if(!a||!p)return;Math.abs(o-$)>u.options.startThreshold&&(b=h.touchend-h.touchmove,f=s*u.options.speedLimit,w=Math.pow(l,2)*s,w=v*(w=w>f?f:v*w)*(e<0?-1:1),b<u.options.moveThreshold&&0!=w&&Math.abs(w)>u.options.offsetThreshold&&(m=u.$wrapper.data("scrollTop")+e+w,g=u.options.duration,m<0?m=0:m>i&&(m=i),u.$wrapper.stop(!0,!1).animate({scrollTop:m},{duration:g,easing:"smooth",complete:function(){v=1}})))}})},_bindKeys:function(){var e=this;e.$el.on("keydown",function(r){var o,t=r.keyCode||r.which,l=e.$wrapper.innerHeight(),a=e.$wrapper.prop("scrollTop"),s=e.$wrapper.prop("scrollHeight")-l;switch(t){case 38:if(r.preventDefault(),a<=0)return;o=a-l;break;case 40:if(r.preventDefault(),a>=s)return;o=a+l;break;default:return}o&&e.$wrapper.stop(!0,!1).animate({scrollTop:o},{duration:e.options.duration,easing:"smooth"})})},_bindScrollbar:function(){function o(e){return l&&e.originalEvent.touches&&(e=e.originalEvent.touches[0]),e.pageY}var t,a,s,i=this,n=e(document);i.$vscrollbar.on("mousedown touchstart",function(e){return e.preventDefault(),l&&e.stopPropagation(),i.isMouseDown=!0,t=r.css3.position(i.$vscrollbar).y,a=o(e),n.on("mouseup."+i.cuid+" mousecancel."+i.cuid+" touchend."+i.cuid+" mousemove."+i.cuid+" touchmove."+i.cuid+" touchcancel."+i.cuid,function(e){if(i.isMouseDown)switch(e.type){case"mouseup":case"touchend":case"mousecancel":case"touchcancel":i.isMouseDown=!1,i.isScrollbarActive||i.$vscrollbar.removeClass("active"),s=0,n.off("."+i.cuid);break;case"mousemove":case"touchmove":s=o(e);var r,l=t-(a-s),c=i.wrapperHeight-i.scrollbarHeight;i.scrollbarStyle.top=l=Math.max(0,Math.min(l,c)),r=(i.scrollHeight-i.wrapperHeight)*(l/c),i.$wrapper.scrollTop(r),e.preventDefault()}else n.off("."+i.cuid)}),!1}).on("mouseenter mouseleave",function(e){i.isScrollbarActive="mouseenter"===e.type,i.$vscrollbar.toggleClass("active",i.isScrollbarActive||i.isMouseDown)})},_bindWheel:function(){var e=this;e.$wrapper.on("mousewheel DOMMouseScroll wheel",function(o){var t=o.originalEvent,l=100*r.dom.getDeltaY(t),a=e.$wrapper[0].scrollTop;e.$wrapper.scrollTop(a-l),e.options.preventScroll?(o.preventDefault(),o.stopPropagation()):e.$wrapper[0].scrollTop!=a&&(o.preventDefault(),o.stopPropagation())})},_moveScrollbar:function(e,o){var l=this;if(l.visibleScroll){if(isNaN(e)&&(e=0),void 0!==o&&l.scrollbarHeight!=o){if(o=Math.max(o,18),l.scrollbarInnerStyle){var a=l.$vscrollbar.children().eq(0).height();l.scrollbarInnerStyle.top=a+"px",l.scrollbarInnerStyle.bottom=a+"px"}l.scrollbarStyle.height=o+"px",l.scrollbarHeight=o}else o=l.scrollbarHeight;l.wrapperHeight<o+e&&(e=l.wrapperHeight-o),r.css3.support?l.scrollbarStyle[t]="translate(0px, "+e+"px)":l.scrollbarStyle.top=e+"px"}},update:function(){var e,r,o,t,a=this;0!==(e=a.$wrapper[0].offsetHeight)?((o=e<(r=a.$wrapper[0].scrollHeight)-1)&&!a._bindedEventOver&&(a._bindedEventOver=!0,l?a._bindContentScroll():(a._bindScrollbar(),a._bindKeys(),a._bindWheel())),a.scrollbarStyle.display=o?"":"none",o!==a.visibleScroll&&(a.visibleScroll=o,a.$el.toggleClass("strack",o)),!o||r===a.scrollHeight&&e===a.wrapperHeight||(a.wrapperHeight=e,a.scrollHeight=r,a.scrollRate=e/r,t=(a.wrapperHeight-a.scrollbarHeight)/(a.scrollHeight-a.wrapperHeight),a._moveScrollbar(a.$wrapper[0].scrollTop*t,e*a.scrollRate))):a.wrapperHeight=0},scrollTop:function(e){var r=this;if(!(arguments.length>0))return r.$wrapper.scrollTop();r.$wrapper.scrollTop(e),r.update()},destroy:function(){var e=this;e.updateTimer&&(clearInterval(e.updateTimer),e.updateTimer=null),e.supr()}});"function"==typeof define&&define.amd&&define("",[],function(){return a})}}(jQuery,window[LIB_NAME]);