!function(t,e,n){"use strict";var i=e.detect,r=e.number,o=e.string.byteLength,u=e.string.indexByByte,a=e.ui("TextCounter",{$statics:{ON_TEXTCOUNT_CHANGE:"textcounter:change"},defaults:{countType:"char",limit:100},initialize:function(t,e){var n=this;!1!==n.supr(t,e)&&(n.currentLength=0,n.placeholder=n.$el.attr("placeholder"),i.isGecko&&n._forceKeyup(),n.on("keydown keyup cut paste blur",function(t){var e=n._checkLimit();"keyup"!==t.type&&"paste"!==t.type||e&&(alert("입력하신 글자 수가 초과되었습니다."),this.focus()),n.trigger(a.ON_TEXTCOUNT_CHANGE,{textLength:n.currentLength})}),n._checkLimit(),n.trigger(l.ON_TEXTCOUNT_CHANGE,{textLength:n.currentLength}))},textLength:function(t){return"byte"===this.options.countType?o(t):(t||"").length},_checkLimit:function(){var t=this,e=t.options,n=!1;return t.currentLength=t.textLength(t.$el.val()),t.currentLength>e.limit&&(t._truncateValue(),n=!0),n},_truncateValue:function(){var t=this,e=t.$el,n=e.trimVal(),i=t.options.limit,r="byte"===t.options.countType,a=0;0===i?(e[0].value=t.placeholder,t.currentLength=i):i<t.currentLength&&(a=r?u(n,i):i,e[0].blur(),e[0].value=n.substring(0,a),e[0].focus(),t.currentLength=r?o(e[0].value):i)},_forceKeyup:function(){var t,e=this,n=e.$el[0],i=window,r=document,o=r.createEvent?function(){var t;i.KeyEvent?(t=r.createEvent("KeyEvents")).initKeyEvent("keyup",!0,!0,i,!1,!1,!1,!1,65,0):((t=r.createEvent("UIEvents")).initUIEvent("keyup",!0,!0,i,1),t.keyCode=65),n.dispatchEvent(t)}:function(){var t=r.createEventObject();t.keyCode=65,n.fireEvent("onkeyup",t)};e.timer=null,e.on("focus",function(){e.timer||(e.timer=setInterval(function(){t!==n.value&&(t=n.value,o())},60))}).on("blur",function(){e.timer&&(clearInterval(e.timer),e.timer=null)})},destroy:function(){var t=this;t.timer&&clearInterval(t.timer),t.supr()}}),l=e.ui("TextControl",a,{$statics:{ON_INIT:"init",ON_CHANGE:"textcontrol:change"},bindjQuery:"textControl",defaults:{limit:100,checkCount:!0,countTarget:"",countText:"<strong>{len}</strong> / {limit}자",autoResize:!1,allowPaste:!0},initialize:function(t,e){var n=this;!1!==n.supr(t,e)&&(n._initTextControl(),n.trigger(l.ON_INIT))},_initTextControl:function(){var n=this,i=n.options;i.allowPaste||n.on("paste",function(t){t.preventDefault(),alert("죄송합니다. \n도배글 등을 방지하기 위해 붙여넣기를 하실 수 없습니다.")}),n.$el.is("textarea")&&i.autoResize&&n._autoResize(),i.checkCount&&n.on("textcounter:change",function(){var o=t(n.options.countTarget),u=e.string,a=function(t,e){o.html(u.format(n.options.countText,{len:r.addComma(t)||0,limit:r.addComma(e)||0}))};return a(n.currentLength,i.limit),function(t,e){n.$el.val()!==n.$el.attr("placeholder")&&a(e.textLength,i.limit)}}())},_autoResize:function(){var t,e,n=this,r=i.isOldIE,o=0;n.$el.css({overflow:"hidden",resize:"none"}),t=r?n.$el.clone().removeAttr("name").removeAttr("id").addClass("d-tmp-textarea").val("").appendTo(n.$el.parent()):n.$el,e=t.height(),t[0].scrollHeight,t[0].scrollHeight!==e&&(o=t.innerHeight()-e),r&&t.hide(),n.on("keyup change input paste focusin focusout",function(){this._layout(this,this.$el,t,e,o)}.bind(n)),n._layout(n,n.$el,t,e,o)},_layout:function(t,e,n,r,o){var u,t=this,a=e.val(),c=t.prevVal,s=i.isOldIE;a!==c&&(t.prevVal=a,n.css("height",""),s&&n.val(a).show()[0].scrollHeight,u=n[0].scrollHeight-o,s&&n.hide(),e.height(u=Math.max(u,r)),t.triggerHandler(l.ON_CHANGE,[u]))},destroy:function(){this.supr()}});l.prototype.defaults.countText="{len} / {limit}byte","function"==typeof define&&define.amd&&define([],function(){return l})}(jQuery,window[LIB_NAME]);